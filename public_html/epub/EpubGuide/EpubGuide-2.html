<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<head>
   <title>&lsquo;Epub Format Construction Guide&rsquo; - HXA7241 : part 2</title>

   <link rel="stylesheet" type="text/css" href="EpubGuide.css" />
</head>


<body>

<div class="edge" id="header"><a href="http://www.hxa.name/articles/"><img src="hxa7241-logo.svg" alt="HXA7241 logo"/></a></div>


<div id="text">

<div class="section" id="packageandcontainerfiles">
<h2>2: Package And Container Files</h2>

   <p>Make these four files, according to the following descriptions:</p>
   <ul>
      <li><a href="#mimetype"><code>mimetype</code></a></li>
      <li><a href="#containerxml"><code>container.xml</code></a></li>
      <li><a href="#contentopf"><code>content.opf</code></a></li>
      <li><a href="#tocncx"><code>toc.ncx</code></a></li>
   </ul>

   <h3 id="mimetype">mimetype</h3>

   <div class="codeblock">
      application/epub+zip
   </div>

   <p>It is ASCII, with no trailing end-of-line.</p>

   <p><a href="EpubGuide-specs.html"><i>Specification: OCF</i></a></p>

   <h3 id="containerxml">container.xml</h3>

   <div class="codeblock">
      &lt;?xml version="1.0"?&gt;<br/>
      &lt;container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container"&gt;
         <div class="codeblock">&lt;rootfiles&gt;
            <div class="codeblock">&lt;rootfile full-path="<span class="highlight">content.opf</span>" media-type="application/oebps-package+xml"/&gt;</div>
         &lt;/rootfiles&gt;</div>
      &lt;/container&gt;
   </div>

   <p>If you rename or put the <code>content.opf</code> file elsewhere than in this guide, change the <code>full-path</code> attribute to match.</p>

   <p><a href="EpubGuide-specs.html"><i>Specification: OCF</i></a></p>

   <h3 id="contentopf">content.opf</h3>

   <div class="codeblock">
      &lt;?xml version="1.0"?&gt;<br/><br/>

      &lt;package xmlns="http://www.idpf.org/2007/opf" unique-identifier="dcidid" version="2.0"&gt;<br/><br/>

         <div class="codeblock">&lt;metadata xmlns:dc="http://purl.org/dc/elements/1.1/"
            xmlns:dcterms="http://purl.org/dc/terms/"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns:opf="http://www.idpf.org/2007/opf"&gt;
            <div class="codeblock">&lt;dc:title&gt;<span class="highlight">Epub Format Construction Guide</span>&lt;/dc:title&gt;<br/>
            &lt;dc:language xsi:type="dcterms:RFC3066"&gt;<span class="highlight">en</span>&lt;/dc:language&gt;<br/>
            &lt;dc:identifier id="dcidid" opf:scheme="<span class="highlight">URI</span>"&gt;<span class="highlight">http://www.hxa7241.org/articles/content/epup-guide_hxa7241_2007_2.epub</span>&lt;/dc:identifier&gt;<br/>
            <span class="highlight">&lt;dc:subject&gt;Non-fiction, technical article, tutorial, Epub, IDPF, ebook&lt;/dc:subject&gt;</span><br/>
            <span class="highlight">&lt;dc:description&gt;A guide for making Epub ebooks/publications, sufficient for most purposes. It requires understanding of XHTML, CSS, XML.&lt;/dc:description&gt;</span><br/>
            <span class="highlight">&lt;dc:relation&gt;http://www.hxa.name/&lt;/dc:relation&gt;</span><br/>
            <span class="highlight">&lt;dc:creator&gt;Harrison Ainsworth / HXA7241&lt;/dc:creator&gt;</span><br/>
            <span class="highlight">&lt;dc:publisher&gt;Harrison Ainsworth / HXA7241&lt;/dc:publisher&gt;</span><br/>
            <span class="highlight">&lt;dc:date xsi:type="dcterms:W3CDTF"&gt;2007-12-28&lt;/dc:date&gt;</span><br/>
            <span class="highlight">&lt;dc:date xsi:type="dcterms:W3CDTF"&gt;2010-08-27&lt;/dc:date&gt;</span><br/>
            <span class="highlight">&lt;dc:rights&gt;Creative Commons BY-SA 3.0 License.&lt;/dc:rights&gt;</span></div>
         &lt;/metadata&gt;</div><br/>

         <div class="codeblock">&lt;manifest&gt;
            <div class="codeblock">&lt;item id="ncx"      href="toc.ncx"                 media-type="application/x-dtbncx+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">css</span>"      href="<span class="highlight">EpubGuide.css</span>"           media-type="text/css" /&gt;<br/>
            &lt;item id="<span class="highlight">logo</span>"     href="<span class="highlight">hxa7241-logo.svg</span>"        media-type="image/svg+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">title</span>"    href="<span class="highlight">EpubGuide-title.html</span>"    media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">contents</span>" href="<span class="highlight">EpubGuide-contents.html</span>" media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">intro</span>"    href="<span class="highlight">EpubGuide-intro.html</span>"    media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">part1</span>"    href="<span class="highlight">EpubGuide-1.html</span>"        media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">part2</span>"    href="<span class="highlight">EpubGuide-2.html</span>"        media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">part3</span>"    href="<span class="highlight">EpubGuide-3.html</span>"        media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">part4</span>"    href="<span class="highlight">EpubGuide-4.html</span>"        media-type="application/xhtml+xml" /&gt;<br/>
            &lt;item id="<span class="highlight">specs</span>"    href="<span class="highlight">EpubGuide-specs.html</span>"    media-type="application/xhtml+xml" /&gt;</div>
         &lt;/manifest&gt;</div><br/>

         <div class="codeblock">&lt;spine toc="ncx"&gt;
            <div class="codeblock">&lt;itemref idref="<span class="highlight">title</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">contents</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">intro</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">part1</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">part2</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">part3</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">part4</span>" /&gt;<br/>
            &lt;itemref idref="<span class="highlight">specs</span>" /&gt;</div>
         &lt;/spine&gt;</div><br/>

         <div class="codeblock">&lt;guide&gt;
            <div class="codeblock">&lt;reference type="<span class="highlight">title-page</span>" title="<span class="highlight">Title Page</span>"        href="<span class="highlight">EpubGuide-title.html</span>" /&gt;<br/>
            &lt;reference type="<span class="highlight">toc</span>"        title="<span class="highlight">Table of Contents</span>" href="<span class="highlight">EpubGuide-contents.html</span>" /&gt;<br/>
            &lt;reference type="<span class="highlight">text</span>"       title="<span class="highlight">Text</span>"              href="<span class="highlight">EpubGuide-intro.html</span>" /&gt;</div>
         &lt;/guide&gt;</div><br/>

      &lt;/package&gt;
   </div>

   <h4>metadata (publication information)</h4>

   <p>Add publication information according to <a href="EpubGuide-specs.html">DCMI</a> terms. Order is not significant, and duplicates are allowed.</p>

   <p>Required terms:</p>
   <ul>
      <li><code>title</code></li>
      <li><code>language</code> &mdash; use a RFC3066 language code</li>
      <li><code>identifier</code> &mdash; use a probably unique string: URI or ISBN would be good</li>
   </ul>

   <p>Optional terms:</p>
   <ul>
      <li><code>creator</code></li>
      <li><code>contributor</code></li>
      <li><code>publisher</code></li>
      <li><code>subject</code></li>
      <li><code>description</code></li>
      <li><code>date</code></li>
      <li><code>type</code></li>
      <li><code>format</code></li>
      <li><code>source</code></li>
      <li><code>relation</code></li>
      <li><code>coverage</code></li>
      <li><code>rights</code></li>
   </ul>

   <p>Some terms have optional attributes:</p>
   <ul>
      <li><code>creator, contributor</code>
         <ul>
            <li><code>opf:role</code> &mdash; see <a href="http://www.loc.gov/marc/relators/">http://www.loc.gov/marc/relators/</a> for values</li>
         </ul>
      </li>
      <li><code>date</code>
         <ul>
            <li><code>opf:event</code> &mdash; unstandardised: use something reasonable</li>
         </ul>
      </li>
      <li><code>identifier</code>
         <ul>
            <li><code>opf:scheme</code> &mdash; unstandardised: use something reasonable</li>
         </ul>
      </li>
      <li><code>date, format, identifier, language, type</code>
         <ul>
            <li><code>xsi:type</code> &mdash; use an appropriate standard term (such as <code>W3CDTF</code> for <code>date</code>)</li>
         </ul>
      </li>
      <li><code>contributor, coverage, creator, description, publisher, relation, rights, source, subject, title</code>
         <ul>
            <li><code>xml:lang</code> &mdash; use RFC-3066 format</li>
         </ul>
      </li>
   </ul>

   <h4>manifest (document file list)</h4>

   <p>List every file that is part of the publication. But not: <code>mimetype</code>, <code>container.xml</code>, <code>content.opf</code> . The order is not significant.</p>

   <p>Give correct mime-type in <code>media-type</code> attribute. <code>id</code>s are required and must be unique in the <code>content.opf</code> file.</p>

   <h4>spine (reading order definition)</h4>

   <p>List all XHTML documents in manifest (using the <code>idref</code>), and not anything else, and with no duplicates. The order is significant. (XHTML documents can be omitted, but then they must not be linked, referenced or reachable from any part of the publication.)</p>

   <h4>guide (main parts of document)</h4>

   <p>This section is optional.</p>

   <p>Each item references a document file, and can have a fragment id. Allowed <code>type</code>s are:</p>

   <ul>
      <li>cover</li>
      <li>title-page</li>
      <li>toc (table of contents)</li>
      <li>index</li>
      <li>glossary</li>
      <li>acknowledgements</li>
      <li>bibliography</li>
      <li>colophon</li>
      <li>copyright-page</li>
      <li>dedication</li>
      <li>epigraph</li>
      <li>foreword</li>
      <li>loi (list of illustrations)</li>
      <li>lot (list of tables)</li>
      <li>notes</li>
      <li>preface</li>
      <li>text</li>
      <li><p>other.[...]</p></li>
   </ul>

   <p><a href="EpubGuide-specs.html"><i>Specifications: OPF, DCMI</i></a></p>

   <h3 id="tocncx">toc.ncx</h3>

   <div class="codeblock">
      &lt;?xml version="1.0"?&gt;<br/>
      &lt;!DOCTYPE ncx PUBLIC "-//NISO//DTD ncx 2005-1//EN" "http://www.daisy.org/z3986/2005/ncx-2005-1.dtd"&gt;<br/><br/>

      &lt;ncx xmlns="http://www.daisy.org/z3986/2005/ncx/" version="2005-1"&gt;<br/><br/>

         <div class="codeblock">&lt;head&gt;
            <div class="codeblock">&lt;meta name="dtb:uid" content="<span class="highlight">http://www.hxa7241.org/articles/content/epup-guide_hxa7241_2007_2.epub</span>"/&gt;<br/>
            &lt;meta name="dtb:depth" content="<span class="highlight">2</span>"/&gt;<br/>
            &lt;meta name="dtb:totalPageCount" content="0"/&gt;<br/>
            &lt;meta name="dtb:maxPageNumber" content="0"/&gt;</div>
         &lt;/head&gt;</div><br/>

         <div class="codeblock">&lt;docTitle&gt;
            <div class="codeblock">&lt;text&gt;<span class="highlight">Epub Format Construction Guide</span>&lt;/text&gt;</div>
         &lt;/docTitle&gt;</div><br/>

         <div class="codeblock">&lt;navMap&gt;
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-1</span>" playOrder="<span class="highlight">1</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">Title Page</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-title.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-2</span>" playOrder="<span class="highlight">2</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">Table of Contents</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-contents.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-3</span>" playOrder="<span class="highlight">3</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">Introduction</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-intro.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-4</span>" playOrder="<span class="highlight">4</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">1: XHTML Documents</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-1.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-5</span>" playOrder="<span class="highlight">5</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">2: Package And Container Files</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-2.html</span>"/&gt;</div>
               <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-6</span>" playOrder="<span class="highlight">6</span>"&gt;
                  <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">mimetype</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
                  &lt;content src="<span class="highlight">EpubGuide-2.html#mimetype</span>"/&gt;</div>
               &lt;/navPoint&gt;</div>
               <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-7</span>" playOrder="<span class="highlight">7</span>"&gt;
                  <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">container.xml</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
                  &lt;content src="<span class="highlight">EpubGuide-2.html#containerxml</span>"/&gt;</div>
               &lt;/navPoint&gt;</div>
               <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-8</span>" playOrder="<span class="highlight">8</span>"&gt;
                  <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">content.opf</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
                  &lt;content src="<span class="highlight">EpubGuide-2.html#contentopf</span>"/&gt;</div>
               &lt;/navPoint&gt;</div>
               <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-9</span>" playOrder="<span class="highlight">9</span>"&gt;
                  <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">toc.ncx</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
                  &lt;content src="<span class="highlight">EpubGuide-2.html#tocncx</span>"/&gt;</div>
               &lt;/navPoint&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-10</span>" playOrder="<span class="highlight">10</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">3: ADE stylesheet</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-3.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-11</span>" playOrder="<span class="highlight">11</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">4: Container Structure</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-4.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
            <div class="codeblock">&lt;navPoint id="<span class="highlight">navPoint-12</span>" playOrder="<span class="highlight">12</span>"&gt;
               <div class="codeblock">&lt;navLabel&gt;
                  <div class="codeblock">&lt;text&gt;<span class="highlight">Specifications List</span>&lt;/text&gt;</div>
               &lt;/navLabel&gt;<br/>
               &lt;content src="<span class="highlight">EpubGuide-specs.html</span>"/&gt;</div>
            &lt;/navPoint&gt;</div>
         &lt;/navMap&gt;</div><br/>

      &lt;/ncx&gt;
   </div>

   <h4>head</h4>

   <p>Set the following <code>meta</code> <code>content</code> attributes:</p>
   <ul>
      <li><code>uid</code> &mdash; to the unique identifier in <code>content.opf</code></li>
      <li><code>depth</code> &mdash; to the depth of the contents tree (in <code>navMap</code>), integer, >= <code>1</code></li>
      <li><code>totalPageCount</code> &mdash; to <code>0</code></li>
      <li><code>maxPageNumber</code> &mdash; to <code>0</code></li>
   </ul>

   <h4>navMap</h4>

   <p>Make a table of contents, optionally hierarchical. (<code>navMap</code> doesn't need to include all XHTML files, since the <code>content.opf</code> spine does.)</p>

   <h4>navPoint</h4>

   <p>Set both attributes:</p>
   <ul>
      <li><code>id</code> &mdash; to be unique in file</li>
      <li><code>playOrder</code> &mdash; to an integer, ordered in <code>navMap</code>, starting at <code>1</code></li>
   </ul>

   <p>Set sub-parts:</p>
   <ul>
      <li>the content of <code>text</code> in <code>navLabel</code></li>
      <li>the <code>src</code> attribute in <code>content</code> &mdash; to a URI of one of the XHTML files (fragment id allowed)</li>
   </ul>

   <p><code>navPoint</code>s nested in <code>navPoint</code>s are allowed.</p>

   <p><i>(The Sony Reader, and perhaps others, have an extra restriction: fragment ids (in <code>src</code> attributes of <code>content</code>s.) are not allowed in top-level (non-nested) <code>navPoint</code>s.)</i></p>

   <p><a href="EpubGuide-specs.html"><i>Specification: NCX</i></a></p>
</div>

</div><!--text-->


</body>

</html>
